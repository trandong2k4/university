<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quản lý Giảng viên | Hệ thống Quản trị</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8fafc;
        }
        .teacher-table tr:nth-child(even) {
            background-color: #f9fafb;
        }
        .teacher-table tr:hover {
            background-color: #f1f5f9;
        }
        .schedule-table td, .schedule-table th {
            border: 1px solid #e2e8f0;
            padding: 8px;
            text-align: center;
        }
        .schedule-table tr:nth-child(even) {
            background-color: #f9fafb;
        }
        .schedule-cell {
            min-width: 120px;
            cursor: pointer;
        }
        .schedule-cell:hover {
            background-color: #ebf8ff;
        }
        .assignment-card {
            transition: all 0.3s ease;
        }
        .assignment-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
        #chat-content::-webkit-scrollbar {
            width: 8px;
        }
        #chat-content::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }
        #chat-content::-webkit-scrollbar-thumb {
            background: #888;
            border-radius: 10px;
        }
        .animate-fade-in {
            animation: fadeIn 0.5s ease-in-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .tab-button {
            transition: all 0.3s ease;
        }
        .tab-button.active {
            background-color: #3b82f6;
            color: white;
        }
    </style>
</head>
<body class="bg-gray-100 text-gray-800">
    <!-- Header -->
    <header class="bg-white shadow-sm sticky top-0 z-30">
        <div class="container mx-auto px-4 py-3 flex items-center justify-between">
            <div class="flex items-center">
                <a href="index.html" class="bg-gray-300 text-gray-800 font-semibold py-2 px-4 rounded-lg hover:bg-gray-400 transition-colors flex items-center mr-4">
                    <i class="fas fa-arrow-left mr-2"></i> Quay lại
                </a>
                <h1 class="text-2xl font-bold text-gray-800">Quản lý Giảng viên</h1>
            </div>
            <div class="flex items-center">
                <div class="mr-4 hidden md:block">
                    <span class="text-gray-700">Xin chào, </span>
                    <span class="font-semibold">Admin</span>
                </div>
                <button id="logoutBtn" class="bg-red-500 hover:bg-red-600 text-white font-semibold py-2 px-4 rounded-lg transition-colors">
                    <i class="fas fa-sign-out-alt mr-2"></i> Đăng xuất
                </button>
            </div>
        </div>
    </header>

    <!-- Main Content Section -->
    <main class="container mx-auto px-4 py-6">
        <!-- Tab Navigation -->
        <div class="bg-white rounded-lg shadow-md mb-6 overflow-hidden">
            <div class="flex flex-col md:flex-row">
                <button id="tab-teachers" class="tab-button active flex-1 py-4 px-6 text-center font-semibold border-b-2 border-blue-500" data-tab="teachers">
                    <i class="fas fa-users mr-2"></i> Danh sách giảng viên
                </button>
                <button id="tab-assignments" class="tab-button flex-1 py-4 px-6 text-center font-semibold border-b-2 border-transparent" data-tab="assignments">
                    <i class="fas fa-tasks mr-2"></i> Phân công giảng dạy
                </button>
                <button id="tab-schedule" class="tab-button flex-1 py-4 px-6 text-center font-semibold border-b-2 border-transparent" data-tab="schedule">
                    <i class="fas fa-calendar-alt mr-2"></i> Lịch giảng viên
                </button>
            </div>
        </div>

        <!-- Teachers Tab -->
        <div id="teachers-tab" class="tab-content animate-fade-in">
            <!-- Action Buttons -->
            <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-6 gap-4">
                <div class="flex gap-2">
                    <button id="addTeacherBtn" class="bg-green-500 hover:bg-green-600 text-white font-semibold py-2 px-4 rounded-lg transition-colors flex items-center">
                        <i class="fas fa-plus mr-2"></i> Thêm giảng viên
                    </button>
                    <button class="bg-blue-500 hover:bg-blue-600 text-white font-semibold py-2 px-4 rounded-lg transition-colors flex items-center">
                        <i class="fas fa-file-export mr-2"></i> Xuất Excel
                    </button>
                </div>
                <div class="w-full md:w-64">
                    <div class="relative">
                        <input type="text" placeholder="Tìm kiếm giảng viên..." class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 pl-10">
                        <i class="fas fa-search absolute left-3 top-3 text-gray-400"></i>
                    </div>
                </div>
            </div>

            <!-- Teacher Table -->
            <div class="bg-white rounded-lg shadow-md overflow-hidden animate-fade-in">
                <div class="overflow-x-auto">
                    <table class="min-w-full teacher-table">
                        <thead>
                            <tr class="bg-gray-100 text-gray-600 uppercase text-sm leading-normal">
                                <th class="py-3 px-6 text-left">Mã GV</th>
                                <th class="py-3 px-6 text-left">Họ tên</th>
                                <th class="py-3 px-6 text-left">Email</th>
                                <th class="py-3 px-6 text-left">Bộ môn</th>
                                <th class="py-3 px-6 text-left">Số điện thoại</th>
                                <th class="py-3 px-6 text-center">Trạng thái</th>
                                <th class="py-3 px-6 text-center">Thao tác</th>
                            </tr>
                        </thead>
                        <tbody class="text-gray-700" id="teacher-table-body">
                            <!-- Data will be populated by JS -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- No data message -->
            <div id="no-data-message" class="bg-white rounded-lg shadow-md p-8 text-center hidden animate-fade-in">
                <i class="fas fa-users text-4xl text-gray-400 mb-4"></i>
                <h3 class="text-xl font-semibold text-gray-600 mb-2">Chưa có dữ liệu giảng viên</h3>
                <p class="text-gray-500 mb-4">Hãy thêm giảng viên mới để bắt đầu quản lý</p>
                <button id="addFirstTeacherBtn" class="bg-green-500 hover:bg-green-600 text-white font-semibold py-2 px-4 rounded-lg transition-colors inline-flex items-center">
                    <i class="fas fa-plus mr-2"></i> Thêm giảng viên đầu tiên
                </button>
            </div>

            <!-- Pagination -->
            <div class="mt-6 flex justify-between items-center">
                <div class="text-sm text-gray-600">
                    Hiển thị <span id="items-count">10</span> trên tổng số <span id="total-items">35</span> giảng viên
                </div>
                <div class="flex space-x-2">
                    <button class="bg-gray-300 hover:bg-gray-400 text-gray-800 font-semibold py-2 px-4 rounded-lg">
                        <i class="fas fa-chevron-left"></i>
                    </button>
                    <button class="bg-blue-500 text-white font-semibold py-2 px-4 rounded-lg">1</button>
                    <button class="bg-gray-300 hover:bg-gray-400 text-gray-800 font-semibold py-2 px-4 rounded-lg">2</button>
                    <button class="bg-gray-300 hover:bg-gray-400 text-gray-800 font-semibold py-2 px-4 rounded-lg">3</button>
                    <button class="bg-gray-300 hover:bg-gray-400 text-gray-800 font-semibold py-2 px-4 rounded-lg">
                        <i class="fas fa-chevron-right"></i>
                    </button>
                </div>
            </div>
        </div>

        <!-- Assignments Tab -->
        <div id="assignments-tab" class="tab-content hidden animate-fade-in">
            <!-- Action Buttons -->
            <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-6 gap-4">
                <div class="flex gap-2">
                    <button id="addAssignmentBtn" class="bg-green-500 hover:bg-green-600 text-white font-semibold py-2 px-4 rounded-lg transition-colors flex items-center">
                        <i class="fas fa-plus mr-2"></i> Thêm phân công
                    </button>
                </div>
                <div class="flex gap-2">
                    <select class="px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                        <option>Tất cả bộ môn</option>
                        <option>Công nghệ thông tin</option>
                        <option>Kế toán</option>
                        <option>Quản trị kinh doanh</option>
                    </select>
                    <select class="px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                        <option>Tất cả học kỳ</option>
                        <option>Học kỳ 1 - 2024</option>
                        <option>Học kỳ 2 - 2024</option>
                    </select>
                </div>
            </div>

            <!-- Assignment Cards -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6" id="assignment-cards">
                <!-- Data will be populated by JS -->
            </div>

            <!-- No data message -->
            <div id="no-assignment-message" class="bg-white rounded-lg shadow-md p-8 text-center hidden animate-fade-in">
                <i class="fas fa-tasks text-4xl text-gray-400 mb-4"></i>
                <h3 class="text-xl font-semibold text-gray-600 mb-2">Chưa có phân công giảng dạy</h3>
                <p class="text-gray-500 mb-4">Hãy thêm phân công mới để bắt đầu quản lý</p>
                <button id="addFirstAssignmentBtn" class="bg-green-500 hover:bg-green-600 text-white font-semibold py-2 px-4 rounded-lg transition-colors inline-flex items-center">
                    <i class="fas fa-plus mr-2"></i> Thêm phân công đầu tiên
                </button>
            </div>
        </div>

        <!-- Schedule Tab -->
        <div id="schedule-tab" class="tab-content hidden animate-fade-in">
            <!-- Action Buttons -->
            <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-6 gap-4">
                <div class="flex gap-2">
                    <select id="teacher-select" class="px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 w-full md:w-64">
                        <option value="">Chọn giảng viên</option>
                        <!-- Options will be populated by JS -->
                    </select>
                </div>
                <div class="flex gap-2">
                    <button class="bg-blue-500 hover:bg-blue-600 text-white font-semibold py-2 px-4 rounded-lg transition-colors flex items-center">
                        <i class="fas fa-print mr-2"></i> In lịch
                    </button>
                    <button class="bg-green-500 hover:bg-green-600 text-white font-semibold py-2 px-4 rounded-lg transition-colors flex items-center">
                        Tuần này
                    </button>
                </div>
            </div>

            <!-- Schedule Table -->
            <div class="bg-white rounded-lg shadow-md overflow-hidden">
                <div class="overflow-x-auto">
                    <table class="min-w-full schedule-table">
                        <thead>
                            <tr class="bg-gray-100">
                                <th class="p-4">Thời gian</th>
                                <th class="p-4">Thứ 2</th>
                                <th class="p-4">Thứ 3</th>
                                <th class="p-4">Thứ 4</th>
                                <th class="p-4">Thứ 5</th>
                                <th class="p-4">Thứ 6</th>
                                <th class="p-4">Thứ 7</th>
                            </tr>
                        </thead>
                        <tbody id="schedule-table-body">
                            <!-- Data will be populated by JS -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- No data message -->
            <div id="no-schedule-message" class="bg-white rounded-lg shadow-md p-8 text-center hidden animate-fade-in">
                <i class="fas fa-calendar-alt text-4xl text-gray-400 mb-4"></i>
                <h3 class="text-xl font-semibold text-gray-600 mb-2">Chưa có lịch giảng dạy</h3>
                <p class="text-gray-500 mb-4">Hãy chọn một giảng viên để xem lịch giảng dạy</p>
            </div>

            <!-- Legend -->
            <div class="mt-6 flex flex-wrap gap-4">
                <div class="flex items-center">
                    <div class="w-4 h-4 bg-blue-100 border border-blue-300 rounded mr-2"></div>
                    <span class="text-sm">Lý thuyết</span>
                </div>
                <div class="flex items-center">
                    <div class="w-4 h-4 bg-green-100 border border-green-300 rounded mr-2"></div>
                    <span class="text-sm">Thực hành</span>
                </div>
                <div class="flex items-center">
                    <div class="w-4 h-4 bg-yellow-100 border border-yellow-300 rounded mr-2"></div>
                    <span class="text-sm">Bài tập</span>
                </div>
                <div class="flex items-center">
                    <div class="w-4 h-4 bg-red-100 border border-red-300 rounded mr-2"></div>
                    <span class="text-sm">Thi/kiểm tra</span>
                </div>
            </div>
        </div>
    </main>

    <!-- Add/Edit Teacher Modal -->
    <div id="teacherModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
        <div class="bg-white rounded-lg shadow-xl w-11/12 md:w-3/4 lg:w-1/2 max-h-screen overflow-y-auto">
            <div class="p-6 border-b border-gray-200">
                <h3 id="modalTitle" class="text-xl font-semibold text-gray-800">Thêm giảng viên mới</h3>
            </div>
            <form id="teacherForm" class="p-6">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                    <div>
                        <label class="block text-gray-700 text-sm font-bold mb-2" for="teacherId">Mã giảng viên</label>
                        <input type="text" id="teacherId" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" required>
                    </div>
                    <div>
                        <label class="block text-gray-700 text-sm font-bold mb-2" for="teacherName">Họ và tên</label>
                        <input type="text" id="teacherName" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" required>
                    </div>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                    <div>
                        <label class="block text-gray-700 text-sm font-bold mb-2" for="teacherEmail">Email</label>
                        <input type="email" id="teacherEmail" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" required>
                    </div>
                    <div>
                        <label class="block text-gray-700 text-sm font-bold mb-2" for="teacherPhone">Số điện thoại</label>
                        <input type="tel" id="teacherPhone" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" required>
                    </div>
                </div>
                <div class="mb-4">
                    <label class="block text-gray-700 text-sm font-bold mb-2" for="teacherDepartment">Bộ môn</label>
                    <select id="teacherDepartment" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" required>
                        <option value="">Chọn bộ môn</option>
                        <option value="cntt">Công nghệ thông tin</option>
                        <option value="kt">Kế toán</option>
                        <option value="qtkd">Quản trị kinh doanh</option>
                        <option value="nn">Ngôn ngữ Anh</option>
                        <option value="dt">Điện - Điện tử</option>
                    </select>
                </div>
                <div class="mb-4">
                    <label class="block text-gray-700 text-sm font-bold mb-2" for="teacherAddress">Địa chỉ</label>
                    <textarea id="teacherAddress" rows="3" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"></textarea>
                </div>
                <div class="flex justify-end space-x-3 pt-4">
                    <button type="button" id="cancelModal" class="bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-2 px-4 rounded-lg transition-colors">
                        Hủy bỏ
                    </button>
                    <button type="submit" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded-lg transition-colors">
                        Lưu lại
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Delete Confirmation Modal -->
    <div id="deleteModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
        <div class="bg-white rounded-lg shadow-xl w-11/12 md:w-1/3 p-6">
            <div class="mb-4">
                <i class="fas fa-exclamation-triangle text-3xl text-red-500 mb-2"></i>
                <h3 class="text-xl font-semibold text-gray-800">Xác nhận xóa</h3>
            </div>
            <p class="text-gray-600 mb-6">Bạn có chắc chắn muốn xóa giảng viên <span id="deleteTeacherName" class="font-semibold"></span>? Hành động này không thể hoàn tác.</p>
            <div class="flex justify-end space-x-3">
                <button id="cancelDelete" class="bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-2 px-4 rounded-lg transition-colors">
                    Hủy bỏ
                </button>
                <button id="confirmDelete" class="bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-4 rounded-lg transition-colors">
                    Xóa
                </button>
            </div>
        </div>
    </div>

    <!-- Chatbot Widget and UI -->
    <div id="chatbot-icon" class="fixed bottom-6 right-6 z-50 bg-blue-600 text-white p-4 rounded-full shadow-lg cursor-pointer hover:scale-110 transition-transform">
        <i class="fas fa-robot text-2xl"></i>
    </div>
    <div id="chatbot-window" class="fixed bottom-20 right-6 w-80 h-96 bg-white rounded-lg shadow-2xl flex flex-col hidden z-50">
        <div class="p-4 bg-blue-600 text-white rounded-t-lg flex justify-between items-center">
            <h4 class="font-bold">Trợ lý Quản lý Giảng viên</h4>
            <button id="close-chat-btn" class="text-white hover:text-gray-200">&times;</button>
        </div>
        <div id="chat-content" class="flex-1 p-4 overflow-y-auto">
            <div class="text-center text-sm text-gray-500">Xin chào! Tôi có thể giúp gì cho bạn về quản lý giảng viên?</div>
        </div>
        <form id="chat-form" class="p-4 border-t border-gray-200 flex">
            <input type="text" id="chat-input" class="flex-1 border-0 rounded-full bg-gray-100 px-4 py-2 focus:outline-none" placeholder="Nhập tin nhắn...">
            <button type="submit" class="ml-2 px-4 py-2 bg-blue-600 text-white rounded-full hover:bg-blue-700">
                <i class="fas fa-paper-plane"></i>
            </button>
        </form>
    </div>

    <script>
        // Sample teacher data
        let teachers = [
            {
                id: 'GV001',
                name: 'Nguyễn Văn A',
                email: 'nguyenvana@university.edu.vn',
                department: 'cntt',
                departmentName: 'Công nghệ thông tin',
                phone: '0123456789',
                address: '123 Đường ABC, Quận 1, TP.HCM',
                status: 'active'
            },
            {
                id: 'GV002',
                name: 'Trần Thị B',
                email: 'tranthib@university.edu.vn',
                department: 'kt',
                departmentName: 'Kế toán',
                phone: '0987654321',
                address: '456 Đường XYZ, Quận 3, TP.HCM',
                status: 'active'
            },
            {
                id: 'GV003',
                name: 'Lê Văn C',
                email: 'levanc@university.edu.vn',
                department: 'qtkd',
                departmentName: 'Quản trị kinh doanh',
                phone: '0369852147',
                address: '789 Đường DEF, Quận 5, TP.HCM',
                status: 'inactive'
            },
            {
                id: 'GV004',
                name: 'Phạm Thị D',
                email: 'phamthid@university.edu.vn',
                department: 'nn',
                departmentName: 'Ngôn ngữ Anh',
                phone: '0569874123',
                address: '321 Đường GHI, Quận 10, TP.HCM',
                status: 'active'
            },
            {
                id: 'GV005',
                name: 'Hoàng Văn E',
                email: 'hoangvane@university.edu.vn',
                department: 'dt',
                departmentName: 'Điện - Điện tử',
                phone: '0789456123',
                address: '654 Đường JKL, Quận Bình Thạnh, TP.HCM',
                status: 'active'
            }
        ];

        // Sample assignment data
        let assignments = [
            {
                id: 'PC001',
                teacherId: 'GV001',
                teacherName: 'Nguyễn Văn A',
                subject: 'Lập trình Web',
                subjectCode: 'LTW',
                class: 'LTW1',
                semester: 'Học kỳ 1 - 2024',
                hours: 45,
                status: 'inprogress'
            },
            {
                id: 'PC002',
                teacherId: 'GV002',
                teacherName: 'Trần Thị B',
                subject: 'Cơ sở dữ liệu',
                subjectCode: 'CSDL',
                class: 'CSDL2',
                semester: 'Học kỳ 1 - 2024',
                hours: 60,
                status: 'completed'
            },
            {
                id: 'PC003',
                teacherId: 'GV001',
                teacherName: 'Nguyễn Văn A',
                subject: 'Lập trình Python',
                subjectCode: 'LTP',
                class: 'LTP3',
                semester: 'Học kỳ 2 - 2024',
                hours: 45,
                status: 'pending'
            },
            {
                id: 'PC004',
                teacherId: 'GV004',
                teacherName: 'Phạm Thị D',
                subject: 'Tiếng Anh chuyên ngành',
                subjectCode: 'TACN',
                class: 'TACN1',
                semester: 'Học kỳ 1 - 2024',
                hours: 30,
                status: 'inprogress'
            }
        ];

        // Sample schedule data
        let schedules = [
            {
                teacherId: 'GV001',
                teacherName: 'Nguyễn Văn A',
                Monday: [
                    { time: '07:30-09:30', subject: 'Lập trình Web', class: 'LTW1', room: 'P.501', type: 'theory' }
                ],
                Tuesday: [
                    { time: '09:30-11:30', subject: 'Lập trình Web', class: 'LTW1', room: 'P.502', type: 'practice' }
                ],
                Wednesday: [],
                Thursday: [
                    { time: '13:30-15:30', subject: 'Lập trình Python', class: 'LTP3', room: 'P.401', type: 'theory' }
                ],
                Friday: [
                    { time: '15:30-17:30', subject: 'Lập trình Python', class: 'LTP3', room: 'P.402', type: 'practice' }
                ],
                Saturday: [],
                Sunday: []
            },
            {
                teacherId: 'GV002',
                teacherName: 'Trần Thị B',
                Monday: [],
                Tuesday: [
                    { time: '07:30-09:30', subject: 'Cơ sở dữ liệu', class: 'CSDL2', room: 'P.301', type: 'theory' }
                ],
                Wednesday: [
                    { time: '09:30-11:30', subject: 'Cơ sở dữ liệu', class: 'CSDL2', room: 'P.302', type: 'practice' }
                ],
                Thursday: [],
                Friday: [
                    { time: '13:30-15:30', subject: 'Cơ sở dữ liệu', class: 'CSDL2', room: 'P.303', type: 'practice' }
                ],
                Saturday: [],
                Sunday: []
            }
        ];

        // Time slots for schedule
        const timeSlots = [
            '07:30-09:30',
            '09:30-11:30',
            '13:30-15:30',
            '15:30-17:30',
            '17:30-19:30'
        ];

        // Days of week
        const daysOfWeek = ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday'];
        const daysOfWeekVi = ['Thứ 2', 'Thứ 3', 'Thứ 4', 'Thứ 5', 'Thứ 6', 'Thứ 7', 'Chủ nhật'];

        // DOM elements
        const teacherTableBody = document.getElementById('teacher-table-body');
        const assignmentCards = document.getElementById('assignment-cards');
        const scheduleTableBody = document.getElementById('schedule-table-body');
        const teacherSelect = document.getElementById('teacher-select');
        const noDataMessage = document.getElementById('no-data-message');
        const noAssignmentMessage = document.getElementById('no-assignment-message');
        const noScheduleMessage = document.getElementById('no-schedule-message');
        const teacherModal = document.getElementById('teacherModal');
        const deleteModal = document.getElementById('deleteModal');
        const modalTitle = document.getElementById('modalTitle');
        const teacherForm = document.getElementById('teacherForm');
        const deleteTeacherName = document.getElementById('deleteTeacherName');
        
        // Current teacher being edited or deleted
        let currentTeacherId = null;
        let currentTab = 'teachers';

        // Functions
        function renderTeacherTable() {
            if (teachers.length === 0) {
                teacherTableBody.innerHTML = '';
                noDataMessage.classList.remove('hidden');
                return;
            }
            
            noDataMessage.classList.add('hidden');
            teacherTableBody.innerHTML = '';
            
            teachers.forEach(teacher => {
                const statusClass = teacher.status === 'active' ? 
                    'bg-green-100 text-green-800' : 'bg-red-100 text-red-800';
                const statusText = teacher.status === 'active' ? 'Đang hoạt động' : 'Ngừng hoạt động';
                
                const row = document.createElement('tr');
                row.className = 'border-b border-gray-200 hover:bg-gray-100';
                row.innerHTML = `
                    <td class="py-3 px-6 text-left font-semibold">${teacher.id}</td>
                    <td class="py-3 px-6 text-left">
                        <div class="font-semibold">${teacher.name}</div>
                        <div class="text-sm text-gray-600">${teacher.departmentName}</div>
                    </td>
                    <td class="py-3 px-6 text-left">${teacher.email}</td>
                    <td class="py-3 px-6 text-left">${teacher.departmentName}</td>
                    <td class="py-3 px-6 text-left">${teacher.phone}</td>
                    <td class="py-3 px-6 text-center">
                        <span class="py-1 px-3 rounded-full text-xs ${statusClass}">${statusText}</span>
                    </td>
                    <td class="py-3 px-6 text-center">
                        <div class="flex item-center justify-center space-x-2">
                            <button class="edit-teacher-btn text-blue-500 hover:text-blue-700" data-id="${teacher.id}">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="delete-teacher-btn text-red-500 hover:text-red-700" data-id="${teacher.id}">
                                <i class="fas fa-trash"></i>
                            </button>
                            <button class="view-teacher-btn text-green-500 hover:text-green-700" data-id="${teacher.id}">
                                <i class="fas fa-eye"></i>
                            </button>
                        </div>
                    </td>
                `;
                teacherTableBody.appendChild(row);
            });
            
            // Add event listeners to edit and delete buttons
            document.querySelectorAll('.edit-teacher-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const teacherId = e.currentTarget.getAttribute('data-id');
                    openEditTeacherModal(teacherId);
                });
            });
            
            document.querySelectorAll('.delete-teacher-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const teacherId = e.currentTarget.getAttribute('data-id');
                    openDeleteModal(teacherId);
                });
            });
        }

        function renderAssignmentCards() {
            if (assignments.length === 0) {
                assignmentCards.innerHTML = '';
                noAssignmentMessage.classList.remove('hidden');
                return;
            }
            
            noAssignmentMessage.classList.add('hidden');
            assignmentCards.innerHTML = '';
            
            assignments.forEach(assignment => {
                let statusClass = '';
                let statusText = '';
                
                if (assignment.status === 'inprogress') {
                    statusClass = 'bg-blue-100 text-blue-800';
                    statusText = 'Đang giảng dạy';
                } else if (assignment.status === 'completed') {
                    statusClass = 'bg-green-100 text-green-800';
                    statusText = 'Đã hoàn thành';
                } else {
                    statusClass = 'bg-yellow-100 text-yellow-800';
                    statusText = 'Chưa bắt đầu';
                }
                
                const card = document.createElement('div');
                card.className = 'assignment-card bg-white rounded-lg shadow-md p-6 border-l-4 border-blue-500';
                card.innerHTML = `
                    <div class="flex justify-between items-start mb-4">
                        <div>
                            <h3 class="font-semibold text-lg">${assignment.subject} (${assignment.subjectCode})</h3>
                            <p class="text-gray-600">${assignment.teacherName}</p>
                        </div>
                        <span class="py-1 px-3 rounded-full text-xs ${statusClass}">${statusText}</span>
                    </div>
                    <div class="mb-4">
                        <div class="flex items-center text-sm text-gray-600 mb-1">
                            <i class="fas fa-users mr-2"></i>
                            <span>Lớp: ${assignment.class}</span>
                        </div>
                        <div class="flex items-center text-sm text-gray-600 mb-1">
                            <i class="fas fa-clock mr-2"></i>
                            <span>Số giờ: ${assignment.hours} tiết</span>
                        </div>
                        <div class="flex items-center text-sm text-gray-600">
                            <i class="fas fa-calendar mr-2"></i>
                            <span>${assignment.semester}</span>
                        </div>
                    </div>
                    <div class="flex justify-between items-center">
                        <button class="text-blue-500 hover:text-blue-700 text-sm">
                            <i class="fas fa-edit mr-1"></i> Chỉnh sửa
                        </button>
                        <button class="text-red-500 hover:text-red-700 text-sm">
                            <i class="fas fa-trash mr-1"></i> Xóa
                        </button>
                    </div>
                `;
                assignmentCards.appendChild(card);
            });
        }

        function renderScheduleTable(teacherId = '') {
            if (!teacherId) {
                scheduleTableBody.innerHTML = '';
                noScheduleMessage.classList.remove('hidden');
                return;
            }
            
            const teacherSchedule = schedules.find(s => s.teacherId === teacherId);
            
            if (!teacherSchedule) {
                scheduleTableBody.innerHTML = '';
                noScheduleMessage.classList.remove('hidden');
                return;
            }
            
            noScheduleMessage.classList.add('hidden');
            scheduleTableBody.innerHTML = '';
            
            timeSlots.forEach(timeSlot => {
                const row = document.createElement('tr');
                
                // Add time slot cell
                const timeCell = document.createElement('td');
                timeCell.className = 'p-4 font-semibold';
                timeCell.textContent = timeSlot;
                row.appendChild(timeCell);
                
                // Add cells for each day
                daysOfWeek.forEach(day => {
                    const cell = document.createElement('td');
                    cell.className = 'p-2 schedule-cell';
                    
                    const daySchedule = teacherSchedule[day];
                    if (daySchedule && daySchedule.length > 0) {
                        const session = daySchedule.find(s => s.time === timeSlot);
                        if (session) {
                            let bgColor = 'bg-blue-100';
                            let borderColor = 'border-blue-300';
                            
                            if (session.type === 'practice') {
                                bgColor = 'bg-green-100';
                                borderColor = 'border-green-300';
                            } else if (session.type === 'exercise') {
                                bgColor = 'bg-yellow-100';
                                borderColor = 'border-yellow-300';
                            } else if (session.type === 'exam') {
                                bgColor = 'bg-red-100';
                                borderColor = 'border-red-300';
                            }
                            
                            cell.innerHTML = `
                                <div class="${bgColor} border ${borderColor} rounded p-2">
                                    <div class="font-semibold">${session.subject}</div>
                                    <div class="text-sm">${session.class}</div>
                                    <div class="text-sm">${session.room}</div>
                                </div>
                            `;
                        }
                    }
                    
                    row.appendChild(cell);
                });
                
                scheduleTableBody.appendChild(row);
            });
        }

        function populateTeacherSelect() {
            teacherSelect.innerHTML = '<option value="">Chọn giảng viên</option>';
            teachers.forEach(teacher => {
                const option = document.createElement('option');
                option.value = teacher.id;
                option.textContent = `${teacher.id} - ${teacher.name}`;
                teacherSelect.appendChild(option);
            });
        }

        function switchTab(tabName) {
            // Hide all tab contents
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.add('hidden');
            });
            
            // Remove active class from all tab buttons
            document.querySelectorAll('.tab-button').forEach(button => {
                button.classList.remove('active', 'border-blue-500');
                button.classList.add('border-transparent');
            });
            
            // Show selected tab content
            document.getElementById(`${tabName}-tab`).classList.remove('hidden');
            
            // Add active class to selected tab button
            document.getElementById(`tab-${tabName}`).classList.add('active', 'border-blue-500');
            document.getElementById(`tab-${tabName}`).classList.remove('border-transparent');
            
            currentTab = tabName;
            
            // If switching to schedule tab, populate teacher select if not already done
            if (tabName === 'schedule') {
                populateTeacherSelect();
            }
        }

        function openAddTeacherModal() {
            currentTeacherId = null;
            modalTitle.textContent = 'Thêm giảng viên mới';
            teacherForm.reset();
            teacherModal.classList.remove('hidden');
        }

        function openEditTeacherModal(teacherId) {
            const teacher = teachers.find(t => t.id === teacherId);
            if (!teacher) return;
            
            currentTeacherId = teacherId;
            modalTitle.textContent = 'Chỉnh sửa thông tin giảng viên';
            
            // Fill form with teacher data
            document.getElementById('teacherId').value = teacher.id;
            document.getElementById('teacherId').disabled = true;
            document.getElementById('teacherName').value = teacher.name;
            document.getElementById('teacherEmail').value = teacher.email;
            document.getElementById('teacherPhone').value = teacher.phone;
            document.getElementById('teacherDepartment').value = teacher.department;
            document.getElementById('teacherAddress').value = teacher.address;
            
            teacherModal.classList.remove('hidden');
        }

        function openDeleteModal(teacherId) {
            const teacher = teachers.find(t => t.id === teacherId);
            if (!teacher) return;
            
            currentTeacherId = teacherId;
            deleteTeacherName.textContent = teacher.name;
            deleteModal.classList.remove('hidden');
        }

        function closeModals() {
            teacherModal.classList.add('hidden');
            deleteModal.classList.add('hidden');
            document.getElementById('teacherId').disabled = false;
        }

        function addTeacher(teacherData) {
            // In a real application, this would be an API call
            teachers.push(teacherData);
            renderTeacherTable();
            closeModals();
            
            // Show success message
            alert('Thêm giảng viên thành công!');
        }

        function updateTeacher(teacherId, teacherData) {
            // In a real application, this would be an API call
            const index = teachers.findIndex(t => t.id === teacherId);
            if (index !== -1) {
                teachers[index] = { ...teachers[index], ...teacherData };
                renderTeacherTable();
                closeModals();
                
                // Show success message
                alert('Cập nhật thông tin giảng viên thành công!');
            }
        }

        function deleteTeacher(teacherId) {
            // In a real application, this would be an API call
            teachers = teachers.filter(t => t.id !== teacherId);
            renderTeacherTable();
            closeModals();
            
            // Show success message
            alert('Xóa giảng viên thành công!');
        }

        // Event Listeners
        document.addEventListener('DOMContentLoaded', () => {
            renderTeacherTable();
            renderAssignmentCards();
            populateTeacherSelect();
            
            // Set up tab switching
            document.querySelectorAll('.tab-button').forEach(button => {
                button.addEventListener('click', () => {
                    const tabName = button.getAttribute('data-tab');
                    switchTab(tabName);
                });
            });
            
            // Set up teacher select change event
            teacherSelect.addEventListener('change', (e) => {
                renderScheduleTable(e.target.value);
            });
        });

        // Add teacher button
        document.getElementById('addTeacherBtn').addEventListener('click', openAddTeacherModal);
        document.getElementById('addFirstTeacherBtn').addEventListener('click', openAddTeacherModal);

        // Logout button
        document.getElementById('logoutBtn').addEventListener('click', function(event) {
            event.preventDefault();
            console.log('Đăng xuất thành công. Chuyển hướng về trang đăng nhập.');
            alert('Đăng xuất thành công. Chuyển hướng về trang đăng nhập.');
        });

        // Teacher form submission
        teacherForm.addEventListener('submit', (e) => {
            e.preventDefault();
            
            const departmentSelect = document.getElementById('teacherDepartment');
            const departmentText = departmentSelect.options[departmentSelect.selectedIndex].text;
            
            const teacherData = {
                id: document.getElementById('teacherId').value,
                name: document.getElementById('teacherName').value,
                email: document.getElementById('teacherEmail').value,
                phone: document.getElementById('teacherPhone').value,
                department: document.getElementById('teacherDepartment').value,
                departmentName: departmentText,
                address: document.getElementById('teacherAddress').value,
                status: 'active'
            };
            
            if (currentTeacherId) {
                updateTeacher(currentTeacherId, teacherData);
            } else {
                addTeacher(teacherData);
            }
        });

        // Delete confirmation
        document.getElementById('confirmDelete').addEventListener('click', () => {
            if (currentTeacherId) {
                deleteTeacher(currentTeacherId);
            }
        });

        // Cancel buttons
        document.getElementById('cancelModal').addEventListener('click', closeModals);
        document.getElementById('cancelDelete').addEventListener('click', closeModals);

        // Close modals when clicking outside
        window.addEventListener('click', (e) => {
            if (e.target === teacherModal) {
                closeModals();
            }
            if (e.target === deleteModal) {
                closeModals();
            }
        });

        // Chatbot logic
        const chatbotIcon = document.getElementById('chatbot-icon');
        const chatbotWindow = document.getElementById('chatbot-window');
        const closeChatBtn = document.getElementById('close-chat-btn');
        const chatForm = document.getElementById('chat-form');
        const chatInput = document.getElementById('chat-input');
        const chatContent = document.getElementById('chat-content');

        chatbotIcon.addEventListener('click', () => {
            chatbotWindow.classList.toggle('hidden');
        });

        closeChatBtn.addEventListener('click', () => {
            chatbotWindow.classList.add('hidden');
        });

        chatForm.addEventListener('submit', (e) => {
            e.preventDefault();
            const userMessage = chatInput.value.trim();
            if (userMessage === '') return;

            const userBubble = document.createElement('div');
            userBubble.className = 'flex justify-end mb-2';
            userBubble.innerHTML = `<div class="bg-blue-500 text-white p-3 rounded-lg max-w-xs">${userMessage}</div>`;
            chatContent.appendChild(userBubble);
            chatInput.value = '';
            chatContent.scrollTop = chatContent.scrollHeight;

            // Simulate AI response based on user message
            setTimeout(() => {
                const aiBubble = document.createElement('div');
                aiBubble.className = 'flex justify-start mb-2';
                
                let responseText = "Tôi có thể giúp gì cho bạn về quản lý giảng viên? Bạn có thể hỏi về cách thêm, sửa, xóa giảng viên hoặc các thao tác khác.";
                
                if (userMessage.toLowerCase().includes('thêm') && userMessage.toLowerCase().includes('giảng viên')) {
                    responseText = "Để thêm giảng viên mới, nhấn vào nút 'Thêm giảng viên' và điền đầy đủ thông tin vào form. Mã giảng viên phải là duy nhất và không trùng với các giảng viên hiện có.";
                } else if (userMessage.toLowerCase().includes('sửa') && userMessage.toLowerCase().includes('thông tin')) {
                    responseText = "Để sửa thông tin giảng viên, nhấn vào biểu tượng chỉnh sửa (cây bút) ở cột 'Thao tác' tương ứng với giảng viên bạn muốn sửa. Lưu ý rằng mã giảng viên không thể thay đổi.";
                } else if (userMessage.toLowerCase().includes('xóa') && userMessage.toLowerCase().includes('giảng viên')) {
                    responseText = "Để xóa giảng viên, nhấn vào biểu tượng thùng rác ở cột 'Thao tác'. Hệ thống sẽ yêu cầu xác nhận trước khi xóa. Lưu ý: hành động này không thể hoàn tác.";
                } else if (userMessage.toLowerCase().includes('phân công')) {
                    responseText = "Để xem phân công giảng dạy, chuyển sang tab 'Phân công giảng dạy'. Tại đây bạn có thể xem tất cả phân công hiện có và thêm phân công mới.";
                } else if (userMessage.toLowerCase().includes('lịch') || userMessage.toLowerCase().includes('thời khóa biểu')) {
                    responseText = "Để xem lịch giảng dạy, chuyển sang tab 'Lịch giảng viên' và chọn giảng viên bạn muốn xem lịch. Lịch sẽ hiển thị các môn học theo ngày và khung giờ.";
                }
                
                aiBubble.innerHTML = `<div class="bg-gray-200 text-gray-800 p-3 rounded-lg max-w-xs">${responseText}</div>`;
                chatContent.appendChild(aiBubble);
                chatContent.scrollTop = chatContent.scrollHeight;
            }, 1000);
        });
    </script>
</body>
</html>