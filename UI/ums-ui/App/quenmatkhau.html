<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quên Mật Khẩu</title>
    <!-- Use Tailwind CSS for modern styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" xintegrity="sha512-Fo3rlrZj/k7g0n7s2xU8W+c/qA8Nf6A2y7t6L/j8E5Jz3r2b+oW9s5/b4/F5A2zR8xV/K6l6zU1e+A9sQ3FjQ==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
    </style>
</head>
<body class="flex items-center justify-center min-h-screen bg-gray-100">

    <!-- Password Reset Card -->
    <div class="w-full max-w-md p-8 bg-white rounded-lg shadow-xl border-t-4 border-blue-500">
        <div class="text-center mb-6">
            <h1 class="text-3xl font-bold text-gray-800">Quên Mật Khẩu</h1>
            <p id="step-description" class="text-gray-500 mt-2">Vui lòng nhập thông tin để xác nhận danh tính.</p>
        </div>

        <!-- Message Box -->
        <div id="messageBox" class="hidden p-3 text-sm rounded-lg transition-opacity duration-300 mb-4">
            <span id="messageText"></span>
        </div>

        <!-- Step 1: Verification Form -->
        <form id="verificationForm" class="space-y-4" onsubmit="handleVerification(event)">
            <div>
                <label for="username" class="block text-sm font-medium text-gray-700 mb-1">Tên đăng nhập</label>
                <div class="relative">
                    <span class="absolute inset-y-0 left-0 flex items-center pl-3">
                        <i class="fas fa-user text-gray-400"></i>
                    </span>
                    <input type="text" id="username" name="username" class="w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-200" placeholder="Nhập tên đăng nhập">
                </div>
            </div>

            <div>
                <label for="phoneNumber" class="block text-sm font-medium text-gray-700 mb-1">Số điện thoại</label>
                <div class="relative">
                    <span class="absolute inset-y-0 left-0 flex items-center pl-3">
                        <i class="fas fa-phone text-gray-400"></i>
                    </span>
                    <input type="tel" id="phoneNumber" name="phoneNumber" class="w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-200" placeholder="Nhập số điện thoại đã đăng ký">
                </div>
            </div>

            <button type="submit" class="w-full py-2.5 bg-blue-600 text-white font-semibold rounded-lg shadow-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition duration-200">
                Tiếp Theo
            </button>
        </form>

        <!-- Step 2: Password Change Form -->
        <form id="passwordChangeForm" class="space-y-4 hidden" onsubmit="handleChangePassword(event)">
            <div>
                <label for="keyvalue" class="block text-sm font-medium text-gray-700 mb-1">Nhập mã xác thực</label>
                <div class="relative">
                    <span class="absolute inset-y-0 left-0 flex items-center pl-3">
                        <i class="fas fa-lock text-gray-400"></i>
                    </span>
                    <input type="password" id="keyvalue" name="xacthuc" class="w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-200" placeholder="Nhập mã xác thực gởi đến SĐT">
                </div>
            </div>


            <div>
                <label for="newPassword" class="block text-sm font-medium text-gray-700 mb-1">Mật khẩu mới</label>
                <div class="relative">
                    <span class="absolute inset-y-0 left-0 flex items-center pl-3">
                        <i class="fas fa-lock text-gray-400"></i>
                    </span>
                    <input type="password" id="newPassword" name="newPassword" class="w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-200" placeholder="Nhập mật khẩu mới">
                </div>
            </div>

            <div>
                <label for="confirmPassword" class="block text-sm font-medium text-gray-700 mb-1">Xác nhận mật khẩu mới</label>
                <div class="relative">
                    <span class="absolute inset-y-0 left-0 flex items-center pl-3">
                        <i class="fas fa-lock text-gray-400"></i>
                    </span>
                    <input type="password" id="confirmPassword" name="confirmPassword" class="w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-200" placeholder="Xác nhận mật khẩu mới">
                </div>
            </div>

            <button type="submit" class="w-full py-2.5 bg-blue-600 text-white font-semibold rounded-lg shadow-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition duration-200">
                Đổi Mật Khẩu
            </button>
        </form>
    </div>

    <script>
        function showMessage(text, type = 'error') {
            const messageBox = document.getElementById('messageBox');
            const messageText = document.getElementById('messageText');
            
            messageText.textContent = text;
            messageBox.className = 'p-3 text-sm rounded-lg transition-opacity duration-300 ' + (type === 'error' ? 'bg-red-100 text-red-700' : 'bg-green-100 text-green-700');
            messageBox.classList.remove('hidden');
            messageBox.classList.add('opacity-100');
        }

        function hideMessage() {
            const messageBox = document.getElementById('messageBox');
            messageBox.classList.remove('opacity-100');
            messageBox.classList.add('hidden');
        }

        // Handle the first step: Verification
        function handleVerification(event) {
            event.preventDefault();

            const username = document.getElementById('username').value.trim();
            const phoneNumber = document.getElementById('phoneNumber').value.trim();
            hideMessage();

            if (username === '' || phoneNumber === '') {
                showMessage('Vui lòng nhập đầy đủ tên đăng nhập và số điện thoại.');
                return;
            }

            // Simulating user data check
            // In a real application, you would make an API call here.
            const validUsername = 'admin';
            const validPhoneNumber = '0000000000';

            if (username === validUsername && phoneNumber === validPhoneNumber) {
                showMessage('Thông tin hợp lệ. Vui lòng nhập mật khẩu mới.', 'success');
                document.getElementById('verificationForm').classList.add('hidden');
                document.getElementById('passwordChangeForm').classList.remove('hidden');
                document.getElementById('step-description').textContent = 'Vui lòng nhập mật khẩu mới.';
            } else {
                showMessage('Thông tin không hợp lệ. Vui lòng kiểm tra lại.');
            }
        }

        // Handle the second step: Password Change
        function handleChangePassword(event) {
            event.preventDefault();

            const newPassword = document.getElementById('newPassword').value.trim();
            const confirmPassword = document.getElementById('confirmPassword').value.trim();
            hideMessage();

            if (newPassword === '' || confirmPassword === '') {
                showMessage('Vui lòng nhập mật khẩu mới và xác nhận mật khẩu.');
                return;
            }

            if (newPassword !== confirmPassword) {
                showMessage('Mật khẩu không khớp. Vui lòng nhập lại.');
                return;
            }

            // Simulating password change
            // In a real application, you would send a request to your backend.
            showMessage('Mật khẩu khớp. Đang tiến hành đổi mật khẩu...', 'success');
            
            // After successful password change
            setTimeout(() => {
                showMessage('Đổi mật khẩu thành công!', 'success');
                // Chuyển hướng về trang đăng nhập hoặc trang chủ
                // window.location.href = 'dangnhap.html';
                console.log('Password successfully changed. Redirecting...');
            }, 1500);
        }
    </script>
</body>
</html>
